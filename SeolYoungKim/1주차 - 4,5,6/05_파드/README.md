# 5. 파드 
## 1) 개념
- 쿠버네티스는 컨테이너를 "파드"라는 단위로 묶어서 관리함 
  - 즉, 여러 개의 컨테이너로 구성됨 
- 파드에 속한 컨테이너들은 모두 노드 하나 안에서 실행됨 
  - 컨테이너들이 같은 목적으로 자원을 공유함 
  - 컨테이너마다 역할 부여 가능 
    - ex: 로그 수집기 컨테이너, 웹 서버 컨테이너, 볼륨 컨테이너 ...
  - 파드 하나 안의 컨테이너들은 IP 하나를 공유함
  - 외부 → 파드의 IP에 접근 → 파드 안 컨테이너와는 포트를 통해 통신 


## 2) 파드 생명주기
### 생명주기
- Pending: 파드를 생성하는 중 
- Running: 파드 안의 모든 컨테이너가 실행 중
- Succeeded: 파드 안 모든 컨테이너가 정상 실행 종료된 상태로 재시작되지 않음
- Failed: 파드 안 모든 컨테이너 중 정상적으로 실행 종료되지 않은 컨테이너가 있는 상태 
  - 컨테이너 종료 코드 != 0 인 경우, 비정상 종료거나 시스템이 컨테이너를 종료한 것 (OOM → 종료코드 137)
- Unknown: 파드의 상태를 확인할 수 없는 상태. 파드가 있는 노드와 통신할 수 없는 경우.


### 상태
- `kubectl describe pods {pod 이름}`을 입력하면 정보가 나옴
- Type
  - Initialized: 모든 초기화 컨테이너가 성공적으로 시작 완료됨
  - Ready: 파드는 요청들을 실행할 수 있고, 연결된 모든 서비스의 로드밸런싱 풀에 추가되어야 한다는 뜻
  - ContainersReady: 파드 안 모든 컨테이너가 준비 상태라는 뜻
  - PodScheduled: 파드가 하나의 노드로 스케줄을 완료했다는 뜻 
  - Unschedulable: 스케줄러가 자원의 부족이나 다른 제약 등으로 지금 당장 파드를 스케줄할 수 없음 
- Status
  - Type의 상태 활성화 여부를 나타냄
  - True, False, Unknown

---

## 3) kubelet으로 컨테이너 진단하기 
- 컨테이너가 실행된 후에는 kubelet이 컨테이너를 주기적으로 전달함
- livenessProbe: 컨테이너가 실행됐는지 확인 
  - 실패 → 컨테이너 종료 → 컨테이너 재시작
- readinessProbe: 컨테이너 실행 후 서비스 요청에 응답할 수 있는지를 진단
  - 엔드포인트 컨트롤러는 해당 파드에 연결된 모든 서비스를 대상으로 엔드포인트 정보를 제거 
  - 실제 트래픽을 받을 준비가 되었음을 확인한 후 트래픽을 받을 수 있음 

### 컨테이너 진단
- 컨테이너가 구현한 핸들러를 kubelet이 호출하여 실행
- 핸들러
  - ExecAction: 컨테이너 내부의 지정된 명령을 실행 → 종료 코드가 0일 때 Success 진단
  - TCPSocketAction: 컨테이너 안에 지정된 IP와 포트로 TCP 상태 확인 → 포트가 열려 있을 시 Success 진단
  - HTTPGetAction: 컨테이너 안에 지정된 IP, 포트, 경로로 HTTP GET 요청을 보냄 → 응답 상태 코드가 200~400이면 Success 진단
- 진단 결과
  - Success, Failure, Unknown

---

## 4) 초기화 컨테이너
